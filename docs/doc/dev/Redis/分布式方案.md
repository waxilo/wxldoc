## 主从复制

核心目的：数据备份、读写分离

最基础的分布式架构，采用一主多从，主节点负责写操作，从节点异步同步主节点数据负责读操作。

**优点**

1. 部署简单
2. 读写分离

**缺点**

1. 无法自动故障转移
2. 写能力、存储容量受单机限制。



## 哨兵模式

核心目的：**高可用**、自动故障转移

部署多个独立的哨兵监控Redis主从节点的健康状态。当主节点被判定为不可用时，哨兵会通过共识算法自动将一个从节点提升为主节点，并让其他从节点指向新的主节点，从而完成故障转移。



### 故障转移

1. 哨兵集群监控每个redis节点



**优点**

1. 读写分离
2. 高可用

**缺点**

1. 需维护哨兵集群。
2. 写能力、存储容量受单机限制。



## Redis Cluster

核心目的：**水平扩展**、高可用、自动分片

采用多个主从集群构成的去中心化的集群网络，将数据分布到**16384个哈希槽**中，每个主从集群负责部分槽位。



### 故障转移

1. 节点每秒会向最久未通信的几个节点（数量根据集群规模来定，一般1-5个）进行PING请求，并且发现某主节点疑似故障，会 **提高对该主节点的 PING 频率**。
2. 当`cluster-node-timeout=15s`时间后依旧异常响应，节点判断该主节点**主观下线**，并将该发现进行广播。
3. 当半数主节点认为该节点下线，则是**客观下线**。
4. 从节点得知自己主节点被客观下线，会等待一个随机延迟，向所有主节点发送`FAILOVER_AUTH_REQUEST`参与选举。
5. 集群中所有主节点进行投票，多数的获胜，晋升为主节点。
6. 新主节点接管槽位的写功能。

**优点**



**缺点**





## 共识算法